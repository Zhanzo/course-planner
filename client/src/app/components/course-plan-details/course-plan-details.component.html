<form [formGroup]="coursePlanForm">
  <h4 class="table-header">Course Selection Statistics</h4>
  <table class="statistics-table">
    <tr>
      <th class="statistics-header">Credits</th>
      <th class="statistics-header">Advanced Credits</th>
      <th class="statistics-header">Basic Credits</th>
    </tr>
    <tr>
      <td class="statistics-data">{{ totalCredits }}</td>
      <td class="statistics-data">{{ advancedCredits }}</td>
      <td class="statistics-data">{{ basicCredits }}</td>
    </tr>
  </table>

  <div class="mb-2">
    <label for="title" class="form-label">Title</label>
    <input
      class="form-control"
      id="title"
      name="title"
      formControlName="title"
      type="text"
    />
  </div>
  <div *ngIf="title.invalid || title.touched">
    <div *ngIf="title.hasError('required')" class="alert alert-danger">
      Name is required.
    </div>
    <div *ngIf="title.hasError('minlength')" class="alert alert-danger">
      Name must be at least 3 characters long.
    </div>
  </div>

  <div cdkDropListGroup class="row">
    <div class="example-container col">
      <h2>Courses:</h2>
      <form>
        <input
          type="search"
          [(ngModel)]="searchText"
          placeholder="Search text"
          class="form-control"
        />
      </form>
      <table class="table example-list">
        <thead>
          <tr>
            <th scope="col">Course code</th>
            <th scope="col">Course name</th>
            <th scope="col">Credits</th>
            <th scope="col">Level</th>
            <th scope="col">Module</th>
            <th period="col">Period</th>
            <th scope="col">Semester</th>
          </tr>
        </thead>
        <tbody
          (cdkDropListDropped)="drop($event)"
          [cdkDropListData]="courses"
          cdkDropList
          cdkDropListSortingDisabled
        >
          <tr
            cdkDrag
            *ngFor="let course of courses | coursefilter: searchText"
            class="example-box"
          >
            <td>{{ course.code }}</td>
            <td>{{ course.name }}</td>
            <td>{{ course.credits }}</td>
            <td>{{ course.level }}</td>
            <td>{{ course.module }}</td>
            <td>{{ course.period }}</td>
            <td>{{ course.semester }}</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="example-container col">
      <h2>Selected Courses:</h2>

      <form>
        <input
          type="search"
          [(ngModel)]="searchTextSelected"
          placeholder="Search text"
          class="form-control"
        />
      </form>
      <table class="table example-list">
        <thead>
          <tr>
            <th scope="col">Course code</th>
            <th scope="col">Course name</th>
            <th scope="col">Credits</th>
            <th scope="col">Level</th>
            <th scope="col">Module</th>
            <th period="col">Period</th>
            <th scope="col">Semester</th>
          </tr>
        </thead>
        <tbody
          (cdkDropListDropped)="drop($event)"
          [cdkDropListData]="selectedCourses"
          cdkDropList
          cdkDropListSortingDisabled
        >
          <tr
            cdkDrag
            *ngFor="
              let course of selectedCourses | coursefilter: searchTextSelected
            "
            class="example-box"
            [ngStyle]="
              hasCollision(course)
                ? { 'background-color': 'red' }
                : { 'background-color': 'white' }
            "
          >
            <td>{{ course.code }}</td>
            <td>{{ course.name }}</td>
            <td>{{ course.credits }}</td>
            <td>{{ course.level }}</td>
            <td>{{ course.module }}</td>
            <td>{{ course.period }}</td>
            <td>{{ course.semester }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <div class="btn-group">
    <button
      [disabled]="!coursePlanForm.valid"
      class="btn btn-success"
      (click)="onSave()"
      type="submit"
    >
      Save
    </button>
    <button class="btn btn-danger" (click)="onDelete()">Delete</button>
  </div>
</form>
